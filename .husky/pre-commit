#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Socket Security Scan
echo "ğŸ” Running Socket Security scan..."

# Verifica se package.json foi modificado
if git diff --cached --name-only | grep -q "frontend/package.json"; then
  echo "ğŸ“¦ Scanning frontend dependencies..."
  cd frontend && npx @socketdev/cli npm audit || exit 1
  cd ..
fi

# Verifica se composer.json foi modificado
if git diff --cached --name-only | grep -q "backend/composer.json"; then
  echo "ğŸ“¦ Scanning backend dependencies..."
  cd backend && npx @socketdev/cli composer audit || exit 1
  cd ..
fi

echo "âœ… Socket Security scan passed!"
